<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
 


   
<!--  xhtml format, hw6 (tables) had to use transitional instead of strict dtd.  -->    
<!--
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">


the one below for strict html:
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

sttrict xhtml:

-->





<!--  
CSS validator: http://jigsaw.w3.org/css-validator/#validate_by_uri
HTML validator: http://validator.w3.org/
-->    
    
<head>
	<title>Sys Admin Pocket Survival Guide</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet" href="psg2.css"                type="text/css" media="screen">
        <link rel="stylesheet" href="psg-table.css"           type="text/css">
        <link rel="stylesheet" href="psg2-links-icons.css"    type="text/css">
        <link rel="stylesheet" href="psg-positioning.css"     type="text/css">
        <link rel="stylesheet" href="psg-print.css" type="text/css" media="print">
</head>

    
<body>
  <div id="fixie"> <!-- add a fixed position example for css final project.   potentially use to place ad, which will appear like a 3rd column on right -->
          <div id="one"   class="skinny"><a href="plug/plug.html"><img src="plug/nema-5-20R-drawing.gif" alt="nema5pic" width="100" height="100"></a></div>
          <div id="two"   class="skinny"><a href="fig/unixoid_hell.gif"><img src="fig/unixoid_hell.gif"  alt="vi-hell"   width="100" height="77" ></a></div>
          <div id="three" class="skinny"><a href="fig/Assistant.gif"><img    src="fig/Assistant.gif"     alt="clippie"   width="100" height="77" ></a></div>
          <div id="four"  class="skinny"><!-- empty for now --></div>
  </div> <!-- closes #fixie -->

    
<div id="wrapper">
  <div id="header">
    <div id="title">Sys Admin Pocket Survival Guide</div>
    <div id="sub-title">A Quick Reference Guide for Sys Admins with Alzeimer :)</div>
  </div> <!-- closes header -->
  
  <div id="navigation">
      <!-- the replace was not inside hightlight area, but whole page, finc and put back some strong and em in doc...-->
   <!--  strong, em, h5, or div are not allowed to be nested inside ul !!  -->
       <div class="azul">Unix</div>
	<ul>
        <li> <a href="sul>.html">Solaris</a></li>
        <li> <a href="linux.html">Linux</a></li>
        <li> <a href="hpux.html">HP-UX</a> and <br>
                <a href="hpux.supl.html">supplement</a></li>
        <li> <a href="aix.html">AIX</a> and <br>
                <a href="aix_cd_catalog.html">AIX CD catalog</a><br></li>
        <li> <a href="irix.html">Irix</a></li>
        <li> <a href="dos.html">Windows</a></li>
        <li> <a href="apple.html">Apple Mac</a></li>
	</ul>

        <div class="azul">Storage</div>
	<ul>
        <li> <a href="netapp.html">NetApp</a></li>
        <li> <a href="emc.html">EMC SAN - Clariion</a></li>
        <li> <a href="emcCelerra.html">EMC NAS - Celerra</a></li>
        <li> <a href="isilon.html">Isilon</a></li>     
        <li> <a href="fs.html">Unix File System</a></li>
	</ul>

        <div class="azul">Big Data</div>
	<ul>
        <li> <a href="lsf.html">LSF, PBS/Torque, LSF.</a></li>
        <li> <a href="mpi.html">MPI, PVM</a></li>
        <li> <a href="sci-file.html">Science File Format/Info</a></li>
        <li><a href="sci-app.html">Sci-App</a></li>
	</ul>
            
      
        <div class="azul">Unix Dev</div>
	<ul>
  	<li><a href="development.html">compilers, etc</a></li>
  	<li><a href="shellScript.txt">sh/bash, csh/tcsh</a></li>
  	<li><a href="awk.txt">AWK</a></li>
  	<li><a href="perl.html">Perl</a></li>
  	<li><a href="python.html">Python</a></li>
  	<li><a href="php.txt">PHP</a></li>
  	<li><a href="javascript_eg.html">javascript_eg</a></li>
   	<li>gcc</li>
  	<li><a href="gdb.html">gdb</a></li>
   	<li>java</li>
   	<li>rcs, cvs, p4, subversion</li>
	<li><a href="vi.html">vi</a></li> 
	</ul>

        <div class="azul">Network</div>
	<ul>
        <li> <a href="net.html">Network</a></li>
        <li> <a href="infiniband.html">InfiniBand</a><br></li>
        <li> <a href="acopia.html">Acopia</a></li>
	</ul>

        <div class="azul">Misc</div>
	<ul>
        <li> <a href="ldap.html">LDAP</a><BR></li>
        <li> <a href="admin.html">General Unix Sys Admin </a></li>
        <li> <a href="tool.html">Sys Admin tools and performance tuning</a></li>
        <li> <a href="vnc.html">VNC, X Emulation</a></li>
        <li> <a href="backup.html">Unix backup</a></li>
        <li> <a href="general_unix.html">Generic Unix Commands</a></li>
        <li> <a href="veritas.html">Veritas</a></li>
        <li> <a href="legato.html">Legato Networker</a></li>
        <li> <a href="mysql.html">MySQL</a></li>
        <li> <a href="html.txt">HTML tags</a></li>
        <li> <a href="wiki.html">WiKi tags</a></li>
        <li> <a href="3rdParty">3rd Party and Vendor Docs Cache</a></li>
	</ul>

        <div class="azul">IMHO</div>
	<ul>
        <li> <a href="monitor.html">Network monitoring tool review</a></li>
        <li> <a href="netArch.html">Network Architecture Approaches</a></li>
        <li> <a href="docPlatform.html">Documentation platform</a></li>
	</ul>

        <div class="azul">Prod Review</div>
	<ul>
        <li><a href="termSvr.html">Terminal (Serial Console) Servers</a></li>
        <li><a href="ent_prod.html">Enterprise Products</a></li>
        <li><a href=""></a></li>
        <li> &nbsp; </li>
	</ul>
            
  </div> <!-- closes #navigation -->


  <!-- ########################################################## -->
  <!-- ########################################################## -->
  
  <div id="content">

      <p>

<div align="CENTER">
<A HREF="http://www.commitstrip.com/en/2016/06/21/childhood-of-a-coder-booting-to-bios/">
<IMG SRC="fig/bios.Strip-Enfance-du-codeur-Le-bios-650-finalenglish-1.jpg"></A>
<BR>
Answer: DEL-F10-F1-DEL-DEL-DEL-F8-F10-F8-F1-DEL-F10-F12-DEL-DEL-F11.  <BR>
In that sequence, to be completed within 3 seconds.
</div>
  
<H1>BIOS</H1>
Do you prefer UEFI?   Really??  <BR>
Anyway, racadm, ipmitool, some stuff are probably common to BIOS and UEFI ;-)  <BR>

<H2>nVidia DGX A100</H2>

DEL or F2 = setup
F11 = boot menu
F12 = PXE boot

Epyc 7742 64-core x2 
2TB RAM?


<H2>Penguin Computing</H2>
<PRE>
F2 = Setup
F10 = Display Boot Menu
F12 = Force Network Boot

For BMC/IPMI was said to default to share eth0 with host os when service RJ45 isn't connected.  
However, my systems wasn't setup that way.  
To make IPMI share eth0 with the host os, set it with:
ipmitool raw 0x2e 0xcc 0x5e 0x2b 0 0x0C 0x01 0x02 

Note that ipmi already have a default admin/admin account as user 2.
If setting new admin acc, try to rename the existing one first:
ipmitool user set name 2 oper
ipmitool user list 1
</PRE>


<!-- did not work:
go to BIOS, Server Management, BMC... Use 
"Mode 2 NCSI"
This hopefully also means that if there is eth connected to the management port, it will use that automatically.

(default, at least for the batch I am workihg on, is set to "mode 1 dedicated").
-->

<H2>HP Proliant (Compaq) Server</H2>

<PRE>
BIOS key combinations (At least for DL 760, but DL 580 should be same)


1st prompt = memory
F1 for memory config
ESC to bypass


2nd prompt = Smart Array (RAID controller, no software support at OS level?)
F8 for config of logical drive.
ESC to cancel.
	If there are failures, F1 to continue w/ drive disabled, F2 (accept data loss and continue)
	It will sit and wait till a choice is made in such cases.

3rd prompt = BIOS

F9 = Option ROM config
F10 = enter setup mode of BIOS  (seems to be some DOS utility that gets run!)
F12 = PXE boot

The prompt seems to change slightly depending on boot time errors.
Major thing is to have finger ready at the keyboard and know what to expect when.

F8 for RAID config
F10 for BIOS

-------------


HP DL 585 (AMD Opteron)

F9 = BIOS setup.  it is diaplayed in bottom right corner while POST is going on during some period.

Ctrl-E = Emulex HBA config

</PRE>


<H2>Lenovo Server</H2>

<PRE>
F1 		Setup
F2		Diagnostics
F12		Select Boot Device	# Need legacy mode to do PXE boot

prompt 2:
Ctrl-S :  Broadcom NIC NexXTreme Ethernet Boot Agent config

prompt 3:
Ctrl-I : MINI config for SERVER RAID 7x controller, only allow minimal logical drive config.
presumably need to boot from CD for full hardware RAID config, such as setup RAID 5 or 1.


</PRE>





<H2>Lenovo Desktop/Laptop</H2>
<PRE>
Enter  (or ThinkVantage button)
ctrl-m = marvell bios setup (sata, raid config)
ctrl-s = mac address config
</PRE>

<H2>SuperMicro</H2>
<p>
During Post, keys:
<PRE>
tab		Display BIOS POST message

del		run setup (BIOS)
F2 		run setup (BIOS)
F11		boot menu
F12		Network boot


RAID controller
AVAGO MegaRAID SAS-MFI BIOS  v5.50.03.0  July 2015)

^P		pause		(disk scanning?)
^V		skip

^H 		WebBIOS       -- ctrl-h load RAID sw to configure virtual drives
^Y		preboot CLI

</PRE>

<H2>Tyan</H2>

<PRE>
del or F2		run setup (AMI BIOS)
F12 boot from ...

ipmitool lan set 8 cipher_privs XXXXXXXXXXXXXXX   # tried for Tyan nodes, but ipmi cipher problem persist
ipmitool lan set 8 cipher_privs caaaaaaaaaaaXXX   # this might have been the default

to have shared IPMI, 
go to bios (ie no ipmitool cli to configure this, PITA)
BMC: "management 2" need to be enabled (was disabled by default).  
enabling that restored config, including all the previous settings :)
(had set a static IP+netmask in the bios, but presumably can use ipmitool to set a new IP as well).


</PRE>

<H2>Asus</H2>

<PRE>
del		run setup (AMI BIOS)
alt+F2 - EzFlash
F8 = BBS POPUP # ie boot device menu


^B PXE prompt for Intel I350 on-board NIC

</PRE>

<H2>Dell</H2>

PowerEdge

<PRE>
F2  = System Setup 
F10 = Lifecycle Controller (BIOS setup)
F11 = Boot Manager
F12 = PXE boot


subsequent prompts sequence:
Ctrl-S : Intel PXE Boot agent config

Ctrl-M : LSI Logic RAID Controller config
Ctrl-A = Avago raid controller

Ctrl-D	: Dell Remote Access Controller Setup (build in kvm over IP)
	  This run on dedicated NIC on service processor card.
	  Machine does not have to be on, but must have power connected.
	  Can be configured to use DHCP and register DDNS ('A' record only).
	  IP will be displayed on boot message.
	  ssh/http/https  (vnc port 5900 seems also open)
	  There is no setup for username/password in the BIOS settings, default login = root/calvin
	  DRAC 4 Firmware 1.33 req Java Plugin version 1.4.2. Firefox ok.


Ctrl-E	: BMC software IPMI server management
	  This need to run on one of the NIC on motherboard.
	  Can be setup for DHCP, but DDNS doesn't work.
	  IP will be displayed on boot message.
	  but no ports seems to be open :(

</PRE>


<H3>HT - Hyperthreading/Logical Processor</H3>
<PRE>
/opt/dell/srvadmin/sbin/racadm get BIOS.ProcSettings.LogicalProc		# query HT status

/opt/dell/srvadmin/sbin/racadm set BIOS.ProcSettings.LogicalProc Disabled	# disable HT
/opt/dell/srvadmin/sbin/racadm jobqueue create BIOS.Setup.1-1			# create job to change BIOS setting
/opt/dell/srvadmin/sbin/racadm serveraction powercycle				# power cycle to effect change
</PRE>


<H3>SNC - Sub NUMA Cluster on Skylake</H3>

Leave SNC disabled (default).
<BR>

See Fig 2 of: 
http://en.community.dell.com/techcenter/high-performance-computing/b/general_hpc/archive/2017/08/01/bios-characterization-for-hpc-with-intel-skylake-processor

<PRE>
Skylake... 14th gen PowerEdge...
"introduce a clustering mode called Sub NUMA clustering (SNC). On CPU models that support SNC, enabling SNC is akin to splitting the single socket into two NUMA domains, each with half the physical cores and half the memory of the socket."

Query Sub NUMA Cluster (SNC) modes 
	- numactl -H 
	- /opt/dell/srvadmin/sbin/racadm get BIOS.ProcSettings.SubNumaCluster
	- lstopo

- SNC=Disabled (default).  ie, two socket show up as two NUMA domains.  
- SNC=Enabled.  within socket has split NUMA domains. two socket system would then have FOUR NUMA domains.  application who does not optimize for memory locality would be worse off.  Thus, not recommended unless benchmark and tuning has been done that benefit from this setting. 

SNC disabled is baseline.  If enable SNC: 
- STREAM, WRF, Fluent, which are highly localized memory optimized, have slight gain of 1-2%
- HPL was ~1% worse off.

	- /opt/dell/srvadmin/sbin/racadm get BIOS.MemSettings.NodeInterleave

- Disabled (default) = system support NUMA (asymmetric) mem config
- Enabled = memory interleave is supported IF symetric memory config is installed.  (SNC will not work when memory configured this way?)
	
</PRE>

See <A HREF="script/hpc/racadmSetBios.sh">racadmSetBios.sh</A> script that set this and many below values. <BR>

<H3>Numa on Epyc Rome 7xx2</H3>


<PRE>

BIOS.ProcSettings.NumaNodesPerSocket # default to 4, and numactl -H will show node with 0 RAM :/
BIOS.ProcSettings.ProcVirtualization 
</PRE>

<H3>Memory Operating Mode</H3>

<PRE>
racadm help BIOS.MemSettings.MemOpMode
	OptimizerMode - Optimizer Mode (default)
	SingleRankSpareMode - Single Rank Spare Mode;
	MirrorMode - Mirror Mode;
	FaultResilientMode - Fault Resilient Mode;

	OppSrefEn=Disabled (default)
</PRE>

<H3>DAPC & GFLOPS/watt</H3>

DAPC profile consume less power than Performance profile, yet said to produce essentially same chrunching power.  [my actual HPL test lost 7% performance]
<BR>
See Fig 3 + 4 of: 
http://en.community.dell.com/techcenter/high-performance-computing/b/general_hpc/archive/2017/08/01/bios-characterization-for-hpc-with-intel-skylake-processor

<PRE>
Skylake... 14th gen PowerEdge...
- In idle state, Performance Profile consumes ~28% more power than DAPC.
- Peak power consumption in DAPC Profile is ~16% less than in Performance Profile. 
- STREAM, WRF have essentialy same performance in either Performance or DAPC mode.
- HPL is 1.05% better in Performance than DAPC mode.  
- Fluent is ~1.01% better.

/opt/dell/srvadmin/sbin/racadm get BIOS.SysProfileSettings.SysProfile
	SysProfile=PerfOptimized	(default)

/opt/dell/srvadmin/sbin/racadm set BIOS.SysProfileSettings.SysProfile PerfPerWattOptimizedOs

	Using PerfPerWattOptimizedDapc:
	- TBA 

	Using PerfPerWattOptimizedOs:
	- Reduce HPL performance by ~7% on Skylake 6130 2.1 GHz 32cores 96G on Dell C6420
	- Exposes HPL clock calculation bug in random manner (cuz it messes with CPU clock?)

  Using LowLatencyOptimizedProfile:
	- This was undocumented profile in 12th Gen PowerEdge
	- said to make a world of difference for latency , but has significant draw on power and will keep all fans blowing on full speed all the time

racadm help BIOS.SysProfileSettings.SysProfile  # list available modes (and dependencies):
	- PerfPerWattOptimizedDapc - Performance Per Watt (DAPC)
	- PerfPerWattOptimizedOs - Performance Per Watt (OS)
	- PerfOptimized - Performance
	- PerfWorkStationOptimized - Workstation Performance;Custom - Custom;
</PRE>

<H3>Other BIOS param</H3>

see  PSG/script/hpc/record_bios_settings.sh  
<BR>
<BR>

<!-- 

## ***** really >>> 
## ***** better to use  PSG/script/hpc/record_bios_settings.sh 

x singularity exec -B /var/run  /global/home/users/tin/sn-gh/dell_idracadm/dell_idracadm.img   /opt/dell/srvadmin/sbin/racadm \
x singularity exec -B /var/run  /global/scratch/tin/singularity-repo/dell_idracadm.img         /opt/dell/srvadmin/sbin/racadm \
x singularity exec -B /var/run  /global/scratch/tin/singularity-repo/dirac1_dell_idracadm.img  /opt/dell/srvadmin/sbin/racadm \
  singularity exec -B /var/run  /global/home/groups/scs/tin/singularity-repo/tin6150-dell_idracadm-master-latest.simg  /opt/dell/srvadmin/sbin/racadm \

export SIFracadm=/global/home/groups/scs/tin/singularity-repo/dirac1_dell_idracadm.img
singularity exec -B /var/run  $SIFracadm /opt/dell/srvadmin/sbin/racadm \
 get BIOS.ProcSettings.LogicalProc    

#### just use pdsh -w n0[218-229].savio3 /global/home/users/tin/PSG/script/hpc/record_bios_settings.sh dell # 2021.0920

# singularity-hub build probably won't work cuz build machine don't have an iDRAC :(


racadm commands, maybe more useful ones

 rollback             - Rollback firmware to its previous version.
 frontpanelerror      - hide LCD errors - color amber to blue
 recover              - Recover firmware to its previous version.
 remoteimage          - make a remote ISO image available to the server
 rollback             - Rollback firmware to its previous version.
 hwinventory          - Monitoring and Inventory of H/W NICs connected to the server.
 update               - Platform Update of the devices on the server
 jobqueue             - Jobqueue of of the jobs currently scheduled
 sensorsettings       - Set the sensor threshold levels.
 getsensorinfo        - got psu of chassis info.


-->

When CPU doesn't perform, check these params (racadm):

<PRE>
  set BIOS.ProcSettings.LogicalProc      Disabled       # non default, but HPC don't want HT on	
  set BIOS.MemSettings.MemOpMode         OptimizerMode	# default, should not need to change this for HPC
  set BIOS.MemSettings.NodeInterleave    Enabled	# non default, not compatible with SubNumaCluster, not typically recommended
  set BIOS.ProcSettings.SubNumaCluster   Enabled	# non default, only useful if app can better utlize localized mem
  set BIOS.SysProfileSettings.SysProfile PerfOptimized	# default
  set BIOS.SysProfileSettings.SysProfile PerfPerWattOptimizedDapc	# said to save energy
  set BIOS.SysProfileSettings.SysProfile PerfPerWattOptimizedOs		# may save energy, seems to introduce clock/timing bug
  set BIOS.ProcSettings.ControlledTurbo  Enabled 	# allow for external control of when to engage turbo?  Def: Disabled.
  get BIOS.ProcSettings.ProcTurboMode			# def Enabled, changeable only in Custom SysProfile 
  get BIOS.SysInformation.SystemBiosVersion             # BIOS version

  set BIOS.SysProfileSettings.SysProfile Custom		# need custom mode to set the next two option:
  set BIOS.SysProfileSettings.ProcCStates Autonomous 	# def: Disabled. alt: Enabled # to allow proc to operate in all avail power state
  set BIOS.SysProfileSettings.UncoreFrequency DynamicUFS	# def: MaxUFS
      # https://software.intel.com/en-us/forums/software-tuning-performance-optimization-platform-monitoring/topic/543513

  # Perhaps also check:

  get BIOS.ProcSettings.UpiPrefetch			# def: Enabled
  get BIOS.MemSettings.OppSrefEn			# def: Disabled 
  get BIOS.SysProfileSettings.MemFrequency		# def: MaxPerf.  Could choose diff speed such as 2666 MHz, 2400, 1866.
  get BIOS.SysProfileSettings.ProcC1E			# def: Disabled  # but enabled when switch to Custom SysProfile !!
							# Enable = processor is allowed to switch to minimum performance state when idle.
  get BIOS.SysProfileSettings.EnergyPerformanceBias	# def: MaxPower (ie Performance).  
							# alt: BalancedPerformance, BalancedEfficiency, LowPower
</PRE>

Note: Lost of redundant power supply may cause system to clock down significantly, eg turbostat may report 800 MHz on a 2.1 GHz CascadeLake 6230.

Checking the following may help to see if there is not enough power supplied to the system:
<PRE>

# enable IPMI/iDRAC:
racadm  set iDRAC.IPMILan.Enable 1
# [Key=iDRAC.Embedded.1#IPMILan.1]


racadm get System.ChassisInfo 
other get options: System.Power System.Power.RedundancyPolicy System.PowerHistorical System.ServerPwr iDRAC.Info iDRAC.WebServer iDRAC.VNCServer
omreport may have data, if can get it to work
dmidecde -t chassis
</PRE>


<!--
singularity exec -B /var/run  /global/home/users/tin/sn-gh/dell_idracadm/dell_idracadm.img /opt/dell/srvadmin/sbin/racadm jobqueue create BIOS.Setup.1-1 

singularity exec -B /var/run  /global/home/users/tin/sn-gh/dell_idracadm/dell_idracadm.img /opt/dell/srvadmin/sbin/racadm  serveraction powercycle 
-->

<H5>Undocumented HPL parameter</H5>

<PRE>
# set env var for HPL to properly use AVX
export HPL_HOST_ARCH=3 # AVX2,  eg Hashwell
export HPL_HOST_ARCH=9 # AVX512 eg Skylake
</PRE>


<H3>KNL BIOS settings</H3>

KNL specific cpu/memory config:

<PRE>
racadm help BIOS.MemSettings...
MemThrottlingMode
	Cltt  (def)
	Oltt

SystemMemoryModel	
	All2All	
	SNC-2
	SNC-4
	Hemisphere
	Quadrant (def)	# 2x2

ProcEmbMemMode		# KNL Memory Mode.  affect "free -h", "numactl -H" 
	Cache (def)
	Memory		# ie flat mode, memory seen in "free -h" and malloc-able.
	Hybrid
BIOS.ProcSettings
DynamicCoreAllocation=Disabled 	-- This field enables or disables the OS capability to put logical processors in the idling state in order to reduce power consumption.
ProcConfigTdp=Nominal 		-- This field allows reconfiguration of TDP (Thermal Design Power) to lower levels.


AMD can't call Hyperthreading, they call it SMT, disabling it need to go to some obscure meny in BIOS, accept some waiver stuff, before can set thread per core.
(at least in Asus)
2021.11 bios has this under Advanced, AMD CBS, CPU Common options, Performance, SMT control.  no more accepting waiver.
Can leave the SVM setting (under CPU config), that's for Virtual machine virtualization instruction.
CBS = ??
</PRE>


    
<H3>Retrieve Serial stored in BIOS</H3>

<PRE>
  racadm  get System.ChassisInfo	# service tag of chassis, eg Dell C6420 chassis
  racadm  get System...			# service tag of blade/sledge


  ipmitool fru | grep Serial   						# list all fru and filter for serial of sledge/blade
  ipmitool raw 0x30 0xc8 0x01 0x00 0x0b 0x00 0x00 0x00 | xxd -r 	# get Dell C6320 chassis service tag vintage 2017
</PRE>

More info, eg fetching Dell C6220 II chassis serial, see: <A HREF="ipmi.html#hexcode">ipmi</A>

<H3>Enter F10 LifeCycle Controller</H3>

https://serverfault.com/questions/866657/racadm-reboot-to-lifecycle-controller
says that one time boot setting to do equiv of pressing F10 is to do:
<PRE>
# racadm set iDRAC.ServerBoot.BootOnce Enabled
# racadm set iDRAC.ServerBoot.FirstBootDevice F10

to get back to normal:

# racadm set iDRAC.ServerBoot.FirstBootDevice Normal
# racadm set iDRAC.ServerBoot.BootOnce Disabled
</PRE>



<H3>Misc</H3>

<PRE>
racadm techsupreport collect 	# start a support collection 
racadm jobqueue view
racadm techsupreport export -f tsr_report.zip         # didn't work via singularity img (cuz idrac version diff?)
racadm supportassist exportlastcollection -f tsr.zip  # via sl7-tools vnfs

racadm racreset		# restart rac, like power cycling the service processor, but not the wipe config and restore to factory default kind of reset, which does have a separate cmd for

</PRE>


<H5>ipmi</H5>

Dell maintain their <A HREF="https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=0992n">own version of ipmi</A> that handles complex situation that RHEL7 ipmitool didn't.
eg: <BR>
<BR>
<PRE>
./ipmitool delloem lan set shared with lom1


singularity exec -B /var/run  /global/scratch/users/tin/singularity-repo/dirac1_dell_idracadm.img  /opt/dell/srvadmin/sbin/racadm get iDRAC.NIC
</PRE>

<!-- 
~tin/sw/dell_ipmi/ipmitool delloem lan set shared with lom1
c00: /local/tin/dell_tool/iDRACTools/ipmitool/usr/bin/ipmitool delloem lan set shared with lom1
-->

<BR>

<PRE>
racadm set iDRAC.NIC.Selection 2

with the selections as follows
1 - Dedicated
2 - LOM1
3 - LOM2
4 - LOM3
5 - LOM4

</PRE>

<!--
# singularity exec -B /var/run  /global/scratch/tin/singularity-repo/dell_idracadm+idracFw.img /opt/dell/srvadmin/sbin/racadm \


# update iDRAC firmware

not worked out yet.

iDRAC: *Extract the firmimg.d7 file*
iDRAC update: https://downloads.dell.com/FOLDER04457642M/1/iDRAC8_2.50.50.50_A00.exe

unzip iDRAC8_2.50.50.50_A00.exe   # produce firmimg.d7 etc
 


racadm fwupdate -p -u -d ./firmimg.d7	# upload firmware, start update.  this didn't work.  
racadm update -f ./firmimg.d7	# upload firmware, start update.  this works.

### error
### sh: bmcfwu.so: command not found
### maybe looking for  /opt/dell/toolkit/bin/bmcfwu.so
### and so may have to install the .BIN in the singularity container...
### *sigh*  building new container to try this...

racadm fwupdate -r   # rollback to standby fw
racadm fwupdate -s   # query update process

# http://www.dell.com/support/home/vi/en/vibsdt1/drivers/driversdetails?driverId=278FC
wget https://downloads.dell.com/FOLDER04457684M/1/iDRAC-with-Lifecycle-Controller_Firmware_278FC_LN_2.50.50.50_A00.BIN

-->

<!--

bios update (not full lifecycle/idrac stuff??)
BIOS_YP88M_WN64_2.9.3_01 as .bin .efi (uEFI uses DOS exec)  .exe   just run on host as root??
	cp -pR /global/scratch/tin/Downloads/dell/  /local

	bash BIOS_YP88M_LN_2.9.3_01.BIN
	Collecting inventory...
	Running validation...
	PowerEdge BIOS
	The version of this Update Package is newer than the currently installed version.
	Software application name: BIOS
	Package version: 2.9.3
	Installed version: 2.5.4
	Continue? Y/N:


-->

<!-- 
install dell OMSA programatically?

wget -q -O - http://linux.dell.com/repo/hardware/latest/bootstrap.cgi | bash
yum install srvadmin-all

ref https://serverfault.com/questions/716467/cant-get-omsa-installed-on-dell-r610-w-centos-6

-->


<H5>Ref</H5>
<A HREF="https://www.intel.com/content/dam/support/us/en/documents/network/omni-adptr/sb/Intel_OP_Performance_Tuning_UG_H93143_v1_0.pdf">Intel E5 v3 (Hashwell) bios param tuning for Fabric</A>(Omnipath, Infiniband).





<H3>Dell Ref</H3>

Ref:
<UL>

<LI><A HREF="http://www.dell.com/support/manuals/us/en/19/dell-opnmang-dplymnt-toolkit-v4.4/dtk_cli-v3/syscfg-for-bios-configuration?guid=guid-928037f2-1410-4547-b2f7-d9b07d702060&lang=en-us">List of many racadm settable params (vs syscfg)</A>
<LI><A HREF="http://www.dell.com/support/manuals/vi/en/vidhs1/dell-opnmang-dplymnt-toolkit-v5.0.1/dtk_cli-v5/syscfg-for-bios-configuration?guid=guid-928037f2-1410-4547-b2f7-d9b07d702060&lang=en-us">v5.0.1 of above</A>

<LI><A HREF="http://topics-cdn.dell.com/pdf/poweredge-c6420_owner%27s%20manual_en-us.pdf">C6420 Spec and Config</A>BIOS/Memory settings in page 40</A>

<LI><A HREF="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwinlpT0wvHYAhUI0mMKHRpJAlkQFggpMAA&url=http%3A%2F%2Fen.community.dell.com%2Fcfs-file%2F__key%2Ftelligent-evolution-components-attachments%2F13-4491-00-00-20-44-05-27%2FBIOS-Setup-User-Guide.pdf%3Fforcedownload%3Dtrue&usg=AOvVaw0ZWFfEd1FlvrKGCYkXhXtS">Dell 14th Gen server (skylake) BIOS settings</A>

<LI><A HREF="http://en.community.dell.com/techcenter/high-performance-computing/b/general_hpc/archive/2017/08/01/bios-characterization-for-hpc-with-intel-skylake-processor">Dell skylake Performance Benchmark results</A> (HPL, Stream, SpecInt, Ansys, etc)

<LI><A HREF="http://www.dell.com/support/manuals/vi/en/vidhs1/dell-opnmang-dplymnt-toolkit-v5.0.1/dtk_cli-v5/syscfg-for-bios-configuration?guid=guid-928037f2-1410-4547-b2f7-d9b07d702060&lang=en-us"></A>
<LI><A HREF="https://downloads.dell.com/manuals/common/poweredge_perf_amdepyc7002series.pdf">Dell Epyc Rome Becnharmk results</A> 
<LI><A HREF="https://www.dell.com/support/article/en-us/sln311501/high-performance-computing?lang=en">Dell HPC results</A>
<LI><A HREF=""></A>
<LI>
</UL>

<BR>

<A NAME="sum"></A>
<A NAME="SUM"></A>
<A NAME="sm"></A>
<A NAME="SM"></A>
<H3>SuperMicro (bios) update manager</H3>
<!-- /global/scratch/tin/sw/sum/sum_2.0.0_Linux_x86_64/sum -->

SUM = supermicro update manager, not the checksum command from the OS!
<BR>
<BR>



<LI> simple binary to extract out of tgz file, then it just run.
<LI> write to current dir for a sum.log file.
<LI> root access required
<LI> Note that older bios output is simple key-value pair flat file, whereas newer bios is in XML format.  (it has nothing to do with SUM version (eg 2.0 vs 2.2, older version with newer bios still produce XML output).

<BR>


<PRE>

untar gz, no real need to install
./sum -h				# not the checksum command in linux default path... 





sum -i 10.10.... -u ADMIN -p ADMIN -c GetBIOSInfo	# use IPMI interface to get info
sum -c GetBIOSInfo			# this find out firmware version info, etc.  run on local machine
sum -c UpdateBios --file BIOS.rom 	# this update bios, not change config

sum -c GetCurrentBiosCfg  --file  smBiosCf.txt	# write output of BIOS settings (HT on or off, etc) to file
sum -c GetCurrentBiosCfg     >    smBiosCf.txt	# should be same, but couple of places have * (default) next to diff entries.  also has SM(c) header, should avoid

vi smBiosCf.txt		# make desired changes to BIOS use hex code for values. eg turn off Hyperthreading
			# remove the first two lines of cfg that had the SM copyright info 
			# in KNL, file was simple text file
			# in skylake, file was xml (UEFI bios?)

sum -c ChangeBiosCfg --file smBiosCf.txt --reboot	# update bios config, rebooting host 
							# --reboot would actually be an soft reboot telling OS to shutdown (via ACPI?)

sum -h -c ChangeBiosCfg				# get help on how to make changes to bios

sum -i ipmi-n0260.savio3 -U admin -P $PASS -c UpdateBIOS --file BIOS_X12DPG-OA6-1B88_20220823_1.4_STDsp.bin  ## --reboot, just do manual ipmi cycle afterwards
## --preserve-config option wasn't operation for SUM 2.8, so have to redo bios changes like logical processor after the update :-\
## very annoyingly, the xml from the GetBiosConfig has mac and IP in it
## there are no commands to change specific setting
## so have to manually edit the xml file for each machine before uploading them to bios to apply the changes.
## SMC, please fix this anoying tedious mess!

sum -c LoadDefaultBiosCfg		
sum -c GetDmiInfo

</PRE>

<!--
/global/home/groups/scs/bin/smc/sum -i ipmi-n0260.savio3 -U admin -P $PASS -c UpdateBIOS --file BIOS_X12DPG-OA6-1B88_20220823_1.4_STDsp.bin  ## --reboot, just do manual ipmi cycle afterwards
-->

Select GetCurrentBiosCfg entries 


<PRE>
sum -c GetCurrentBiosCfg | egrep --color 'Hyper-Threading|Turbo|CPU\ C\ State=|Cluster\ Mode=|Memory\ Mode=' 
</PRE>

<PRE class="cf">
[Advanced|Boot Feature]
Quiet Boot=01                           // Please enter the value in 2 hexadecimal digits. Default value is <<<01>>>

[Advanced|Processor Configuration]
Intel(R) Hyper-Threading Technology=01  // 01 (Disable), *00 (Enable)

[Advanced|Processor Configuration|Advanced Power Management Configuration|CPU P State Control]
Energy efficient P-state=01             // 00 (Disable), *01 (Enable)
Turbo Mode=01                           // 00 (Disable), *01 (Enable)

[Advanced|Processor Configuration|Advanced Power Management Configuration|CPU C State Control]
CPU C State=01                          // 00 (Disable), *01 (Enable)


[Advanced|Chipset Configuration|North Bridge|Uncore Configuration]
Cluster Mode=00                         // *00 (All2All), 01 (SNC-2), 02 (SNC-4), 03 (Hemisphere), 04 (Quadrant), 05 (Auto)
Memory Mode=01                          // *01 (Flat), 00 (Cache), 02 (Hybrid), 03 (Auto)
MCDRAM Cache Size=02                    // 01 (25% of MCDRAM size), *02 (50% of MCDRAM size)        Memory Mode = "Flat" or Memory Mode = "Cache" or Memory Mode = "Hybrid" and Memory Mode = "Cache" or Memory Mode = "Hybrid" or Memory Mode = "Auto" and Memory Mode = "Flat" or Memory Mode = "Hybrid" or Memory Mode = "Auto"
Treat MCDRAM as Hot-Pluggable Memory=00 // *00 (no), 01 (yes)        Memory Mode = "Flat" or Memory Mode = "Cache" or Memory Mode = "Hybrid" and Memory Mode = "Flat" or Memory Mode = "Hybrid" or Memory Mode = "Auto"
OPIO Parallel Training=01               // *01 (Enable), 00 (Disable)
OPIO Parallel Training Channel Count=08 // Please enter the value in 2 hexadecimal digits. Default value is <<<08>>>        OPIO Parallel Training = "Enable"
MCDRAM Repair=01                        // 00 (Disable), *01 (Enable)
MCDRAM Diagnostics=01                   // 00 (Disable), *01 (Enable)        MCDRAM Repair = "Disable"
MCDRAM Data in NVRAM=01                 // 00 (Disable), *01 (Store), 02 (Use), 03 (UseStore)
EDC Demand Scrub=01                     // *01 (Enable), 00 (Disable)
EDC Patrol Scrub=01                     // 00 (Disable), *01 (Enable)


[Advanced|Serial Port Console Redirection|COM1 Console Redirection Settings]
Terminal Type=01                        // 00 (VT100), *01 (VT100+), 02 (VT-UTF8), 03 (ANSI)
Bits per second=07                      // 03 (9600), 04 (19200), 05 (38400), 06 (57600), *07 (115200)
Data Bits=08                            // 07 (7), *08 (8)
Parity=01                               // *01 (None), 02 (Even), 03 (Odd), 04 (Mark), 05 (Space)
Stop Bits=01                            // *01 (1), 03 (2)
Flow Control=00                         // *00 (None), 01 (Hardware RTS/CTS)
Legacy OS Redirection Resolution=01     // 00 (80x24), *01 (80x25)
Putty KeyPad=01                         // *01 (VT100), 02 (LINUX), 04 (XTERMR6), 08 (SCO), 10 (ESCN), 20 (VT400)
Redirection After BIOS POST=00          // *00 (Always Enable), 01 (BootLoader)

</PRE>


<H5>SMC IPMI</H5>

Info from 
<A HREF="https://serverfault.com/questions/361940/configuring-supermicro-ipmi-to-use-one-of-the-lan-interfaces-instead-of-the-ipmi">serverfault</A>

<BR>
<BR>

Supermicro has an IPMICFG 
util that allows for custom commands like below.
Get tool from: 
<A HREF="ftp://ftp.supermicro.com/utility/IPMICFG/">ftp</A> 
<A HREF="https://drive.google.com/file/d/1Htsgax0VA_xZnPFkWD2AxCh_NlTY75JT/view?usp=sharing">Google Drive ver 1.31.1</A>

<BR> 
<BR> 

To change vlan tagging:

<PRE>
./IPMICFG-Linux.x86_64  -vlan off
</PRE>



To reset the service processor:

<PRE>
run ipmicfg -fde to reset all settings back to factory default,
then ipmicfg -r to do a BMC cold reset
after reset,  ipmicfg -m to see what’s IP, try ping it.
</PRE>




To change which interface is used for IPMI:

<PRE>
sudo ipmiutil lan -e										# check config
sudo ipmiutil smcoem lanport            # find current setting
sudo ipmiutil smcoem lanport dedicated  # set to use dedicated lom port
sudo ipmiutil smcoem lanport lan1       # set to shared
sudo ipmiutil smcoem lanport failover   
</PRE>

instead of getting the util, can apparently just use raw commands via ipmitool.
worked in 2020 on a server w/ cascade lake processor.  <BR>
  <BR>
It is slightly unerving not knowing what it is really doing and if it would work on a server of a different vintage... hopefully it can't do lasting damage.  <BR>
It didn't look like SUM was able to change the IPMI interface settings.  <BR>

<PRE>

To get LAN mode:                ipmitool raw 0x30 0x70 0x0c 0
		output (entry for [B] for set):
		0x00 = Dedicated, 
		0x01 = Onboard / Shared 
		0x02 = Failover 
		[A] = 0  is get
		[A] = 1  is set
.                                                           A B
To set LAN mode dedicated:      ipmitool raw 0x30 0x70 0x0c 1 0
To set LAN mode onboard/shared: ipmitool raw 0x30 0x70 0x0c 1 1
To set LAN mode failover:       ipmitool raw 0x30 0x70 0x0c 1 2        # this seems like default; this settings worked as "shared"



some say hard reboot needed, other says work right away without reboot.
Apparently default depends whether were is live rj45 connected to the dedicated ipmi port when power was connected to computer.  So some changes may need power disconnect for it to take effect?


</PRE>

<!--

from google cache, maybe 



 [root@freenas ~]# ipmitool raw 0x30 0x70 0x66 0x01 0x01 ... Intel S5500WB/Penguin Computing Relion 700, Intel S2600JF/Appro 512X, ...

so vs smc:
To get LAN mode:                
  ipmitool raw 0x30 0x70 0x0c 0              # smc get
  ipmitool raw 0x30 0x70 0x66 0x01 0x01      # ?  smc fan speed?  dont mess with ipmiraw unless sure what it does!
-->

Additional SMC IPMI raw commands in their 
<A HREF="https://www.supermicro.com/support/faqs/faq.cfm?faq=15868">support faq 15868</A>.
It is from 2003, and both X8 and X9, AMI or ATEN BIOS, seems to take the same set of commands.

<H5> Asus Raw </H5>

<PRE>
use this carefully
this was for a ESC 4000 (G4?) 2U GPU node
reset bmc to be programmed via cli ipmitool.
changing that thing on the bios is weird.

As with all raw commands, use at your own risk! :-D

asus in general just use channel 8.
But for that one machine had to issue this raw ipmi command to get things reset/fixed:

ipmitool raw 0x32 0x71 0x00 0x01 0x01 # set ipmi/bmc to use shared nic
ipmitool lan set 8 cipher_privs XaaaaaaaaaaaXXX   # reset cipher suite allowed for channel 8


</PRE>

For IPMI and OS to share NIC, it needs to support NCIS.  Otherwise, the BMC will need a dedicated connection for IPMI access.
eg: Intel I350 has this support. https://www.gigabyte.com/us/Enterprise/Accessory/CLN4314-rev-10


<!-- these should move to ipmi.html -->
<H5>Asus IPMI raw</H5>

As with all raw commands, 
<B>
use at your own risk! :-D</B>

<PRE>


# toggle on/off among the diff settings/interfaces should revive ipmi over lan

# For Asus ESC4000 G4 series for Intel Skylake/Cascadelake
# BMC likely ASpeed ast2500 
ipmitool raw 0x32 0x71 0x00 0x01 0x01 	# set ipmi/bmc to use shared nic		
# For Asus ASMB7-iKVM (P9D-MV)
ipmitool raw 0x32 0x71 0x00 0x01 0x03		#    activate ipmi/bmc  on lan1 (shared with host/os nic)
ipmitool raw 0x32 0x71 0x00 0x01 0x00		# de-activate ipmi/bmc  on lan1 (shared with host/os nic)
ipmitool raw 0x32 0x71 0x00 0x00 0x03	  #    activate ipmi/bmc  on dm_lan1 (dedicated management port)
ipmitool raw 0x32 0x71 0x00 0x00 0x00   # de-activate ipmi/bmc  on dm_lan1 (dedicated management port)

ref: https://www.thomas-krenn.com/de/wiki/IPMI_Netzwerkports_von_ASUS_Mainboards_konfigurieren

# Asus ESC4000 E10 is for AMD Epyc Naples/Rome 7xx2 series, 
# BMC is ASMB10-iKVM, which Uses newer ASpeed ast2600 

</PRE>


<H2>Asus Bios Tool</H2>


<LI><A HREF="https://asuscontrolcenter.asus.com/#/us">Asus Controller</A> <BR>
	<A HREF="https://dlcdnets.asus.com/pub/ASUS/server/ACC/E15395_ASUS_Control_Center_EM_CSM_V5_WEB.pdf">PDF manual</A> 
<BR>
	Compared to SuperMicro SUM, it’s more like a centralized management utility, not as compact, but has a lot of functions. Refer to the “BIOS setting” section.  <BR>
	The bloody zip file is a .ova VirtualBox image :-\ 

</LI>

<BR>


<LI><A HREF="https://www.asus.com/Commercial-Servers-Workstations/ESC4000-G4/HelpDesk_BIOS/">ESC4000 G4</A>(Intel) Bios firmware <BR>
	.cab file, but once get into bios, have option that read the .cab file and update bios.  Windows/DOS NOT needed :)
  
</LI>
<LI><A HREF="https://www.asus.com/Networking-IoT-Servers/Servers/GPU-Servers/ESC4000A-E10/HelpDesk_BIOS">ESC4000A E10</A>(AMD Epyc 7xx2 Rome) </LI>
<LI><A HREF=""></A> </LI>

<H5>Dell IPMI raw</H5>

Dell sledge C6520 with ice lake processor, in C400-S chassis (4 nodes in 2U chassis, 2022, psu with C19 connectors).  <BR>
Not sure what will happen if you use this on some other machines, so be warned!  Best to check with your support engineer(s). 
<BR>
thx to Dell Support Engineers for the these raw commands, eg RM, RS, 
<!-- 2023-0210 152512273 6YL82N3 -->
<BR>
<BR>

<PRE>

Query:
ipmitool -I lanplus -H 100.74.7.117 -U root -P L3-C@lvin raw 0x30 0x1f
Output will look similar to:  01 60 08 00 01 01 01dd 00 b8 00

 01 3a 08 00 01 01 01 6c 00 4f 00 = PSU in 1+1 redundancy, F1 warning on boot.

 01 73 08 00 01 01 01 34 01 4c 01 
 01 87 08 00 01 01 01 32 01 3a 01   
 01 87 08 00 00 02 00 40 01 2d 01 # n0057  PSU in 2+0, no F1 warning on boot.
 01 8e 08 00 01 01 01 3d 01 28 01 # n0009 none of these has no F1 warning
 01 99 08 00 01 01 01 1d 02 3b 02 # n0035
 #           ^^ ^^ ------------------ indicate whether is 1+1 or 2+0 mode


# Set psu redundancy to 2+0, 
ipmitool raw 0x30 0xc7 0x11 0x02 0x00
#                           ^^2^ ^^0^  for 2+0

# This is changing back to 1+1 redundancy.  In this mode, sledge boot up will complain not enough power and ask F1 to ack before continue booting
ipmitool raw 0x30 0xc7 0x11 0x01 0x01
#                           ^^1^ ^^1^  for 1+1


# Enable FTR (so that node will re-calculate power requirements and negotiate with chassis, after cold power cycle)
ipmitool -I lanplus -H ipmi-n0059 -U admin -P $IPMIP  raw  0x6 0x34 0x45 0x70 0xc0 0xc8 0x20 0x0 0xa1 0x1 0x01 0x1a 0x01 0xd8
# check FTR status
ipmitool -I lanplus -H ipmi-n0059 -U admin -P $IPMIP  raw  0x6 0x34 0x45 0x70 0xc0 0xc8 0x20 0x0 0xa0 0x0 0x01 0x1a 0xd8


# Reboot Chassis Management
ipmitool raw 0x06 0x34 0x45 0x70 0x18 0xc8 0x20 0x00 0x02 0xd8   ## old cmd, didn't quite work
ipmitool raw  0x6 0x34 0x45 0x70 0x18 0xc8 0x20 0x0 0x2 0xd8     ## new cmd, reset chassis, pwr off all nodes.
# probably equivalent to:
racadm  cmreset


</PRE>

<BR>

<H1>Service Processor</H1>

<H2>
tool to manipulate BIOS firmware using cli tool
</H2>


<A NAME="dell_support_assist"></A>
<H2>Dell Support Assist</H2>

<PRE>

singularity exec -B /var/run  /global/scratch/users/tin/singularity-repo/dirac1_dell_idracadm.img  \
/opt/dell/srvadmin/sbin/racadm  supportassist collect

Job ID = JID_926261291256
RAC1154: The requested operation is initiated.

Run the RACADM jobqueue sub-command, using the job id to check the status of
the requested operation.


racadm  jobqueue view
-------------------------JOB QUEUE------------------------
[Job ID=JID_926261291256]
Job Name=SupportAssist Collection
Status=Completed
Start Time=[Not Applicable]
Expiration Time=[Not Applicable]
Message=[SRV088: The SupportAssist Collection Operation is completed successfully.]
Percent Complete=[100]
----------------------------------------------------------

/opt/dell/srvadmin/sbin/racadm  supportassist  exportlastcollection -f tsr.zip

# ftp server??!!
racadm supportassist exportlastcollection -l ftp://192.168.10.24/share -u myuser -p mypass


racadm supportassist accepteula

# collect debug log, -f is filename , but tends to have problem saving, cuz of singularity?
racadm  supportassist  collect -t Debug -f n0049_tsrd.zip

this "file save" worked  savio4 icy lake 2022.10.21
alias racadm="singularity exec -B /var/run  /global/scratch/users/tin/singularity-repo/dirac1_dell_idracadm.img  /opt/dell/srvadmin/sbin/racadm"
cd $HOME # cd /root  , cuz singularity bind mount HOME, and lower dir tends to cause error!
racadm techsupreport export -f tsr_report.zip


</PRE>
<!--

	# this didn't work, not sure where file went:
  /global/scratch/tin/singularity-repo/dirac1_dell_idracadm.img  /opt/dell/srvadmin/sbin/racadm  supportassist  exportlastcollection -f tsr.zip

-->

<A NAME="UpdateIDRAC"></A>
<A NAME="updateIdrac"></A>
<H2>Update iDRAC</H2>
Can also update chassis System Management Firmware via racadm running on the node.
<!--
[root@n0059.savio4 /global/home/users/tin/gs/Downloads/dell/sav4]# singularity exec -B /var/run  /global/scratch/users/tin/singularity-repo/dirac1_dell_idracadm.img  /opt/dell/srvadmin/sbin/racadm 
-->

<PRE>
# the EXE is a PE32 executable, ok from linux, just copy from local fs to the SP and let it update:

racadm update -f iDRAC-with-Lifecycle-Controller_Firmware_RTTPH_WN64_5.10.50.00_A00.EXE
racadm jobqueue view            # wait for download, start, etc.

# run chassis firmware on 1 node/chassis only!
racadm update -f Chassis-System-Management_Firmware_N5WNX_WN64_3.51_A00.EXE
racadm jobqueue view            # wait for download, start, etc.

racadm get iDRAC.Info.Version
racadm get System.ChassisInfo.FirmwareVersion
racadm get BIOS.SysInformation.SystemBiosVersion
</PRE>


<A NAME="dsa"></A>
<H2>IBM/Lenovo DSA</H2>

Lenovo Dynamic System Analyst (DSA).  
<BR>
Collect system state/log for support to review.
Portable version for rhel7 worked for vNFS n0096.s2
<BR>

Download 
( <A HREF="https://support.lenovo.com/us/en/downloads/ds121924">https://support.lenovo.com/us/en/downloads/ds121924</A> )
self extracting elf .bin and right away run the program.  don't seems to leave any binary behind when finsih.
When finished, leave collected log in /var/log/Lenovo_Support
Probably same thing that is invoked by "bios" collect tool, which save result to usb.
<BR>

Preliminary okay to give sudo to intern to run... 
keep a stable binary version in a non-writable place...


<PRE>
wget https://download.lenovo.com/servers/mig/2017/05/17/6836/lnvgy_utl_dsa_dsala7d-10.3_portable_rhel7_x86-64.bi
sudo ./lnvgy_utl_dsa_dsala7d-10.3_portable_rhel7_x86-64.bin
!--
</PRE>

<!--

**^ 096.savio2 /global/home/groups/scs/tin/lenovo_dsa ^**>  sudo ./lnvgy_utl_dsa_dsala7d-10.3_portable_rhel7_x86-64.bin 
Lenovo Dynamic System Analysis
(C) Copyright Lenovo Corp. 2014-2017.(C) Copyright IBM Corp. 2004-2014.  All Rights Reserved.
This Program is licensed under the terms of the agreement available by invoking
this utility with the -l option.  By extracting, copying, accessing, or using
the Program, you agree to the terms of this agreement.  If you do not agree to
the terms, please remove the software and return it to Lenovo or the reseller
from whom you acquired the software for a refund, if any.

Extracting...
Executing...


Logging level set to Status
Copying Schema...
cp: cannot stat '/etc/sysconfig/network/*-usb*': Not a directory
cp: cannot stat '/etc/sysconfig/network-scripts/*-usb*': No such file or directory
Dynamic System Analysis Version 10.3.A7D

(C) Copyright Lenovo Corp. 2014-2017. All Rights Reserved. (C) Copyright IBM Corp. 2004-2014. All Rights Reserved.

Running DSA IMM plug-ins pass 1.
   IMM: Integrated Management Module Collector 
Running DSA IMM plug-ins pass 2.
   IMM: Integrated Management Module Collector 
Running DSA IPMI plug-ins pass 1.
Running DSA IPMI plug-ins pass 2.
Running DSA collector plug-ins pass 1.
   libasuprovider: Advanced Setting Utility(ASU) Setting Collector 
   libbist: BIST 
   libdiskmgt: Disk Management Information Collector 
sh: xdpyinfo: command not found
   libdisplayinfo: Display Information Collector 
   libeventlog: Eventlog Collector 
   libfileloader: File Loader 
   libhardwareinfo: Hardware Information Collector 
   libinstalledapps: Installed Application Collector 
   libipmisel: IPMISEL
   liblightpath: LightPath
   libmodinfo: Linux module information collector
   libnetworkinfo: Network Information Collector
   libnuma: NumaLib
   libnvsmilog: NVIDIA SMI Log Collector
   libpciinfo: PCI Information Collector
   libprocess: Process
   libqlogic: QLogic HBA(s) Collector
   libscsidev: SCSI/IDE Device Collector
   libspddata: SPDData
   libspfirmwarevpd: SPFirmwareVPD
   libspintreg: Engineering Information Collector
   libsysconfig: SysConfig
   libsystem: System
   libtapehdd: Tape/HDD Collector
   libusbinfo: USB Information Collector
Running DSA collector plug-ins pass 2.
   libbist: BIST
   libdiskmgt: Disk Management Information Collector
   libdisplayinfo: Display Information Collector
   libhardwareinfo: Hardware Information Collector
   libinstalledapps: Installed Application Collector
   libmodinfo: Linux module information collector
   libnetworkinfo: Network Information Collector
   libnuma: NumaLib
   libpciinfo: PCI Information Collector
   libqlogic: QLogic HBA(s) Collector
   libscsidev: SCSI/IDE Device Collector
   libspfirmwarevpd: SPFirmwareVPD
   libsysconfig: SysConfig
   libtapehdd: Tape/HDD Collector
   libusbinfo: USB Information Collector
Running DSA cmpi plug-ins pass 1.
   libFoDProviderModule: FoD Collector
   libQpiCol_Module: QpiCol_Module
   libsmart: HardDrive S.M.A.R.T Information Collector
Running DSA cmpi plug-ins pass 2.
   libFoDProviderModule: FoD Collector
   libsmart: HardDrive S.M.A.R.T Information Collector
Running DSA Pegasus Single-thread Group plug-ins pass 1.
Running DSA Pegasus Single-thread Group plug-ins pass 2.
Running DSA Pegasus Multi-threads Group plug-ins pass 1.
   libbrcdprovider_Module: brcdprovider_Module
   libDimmModule_Module: DimmModule_Module
   libemulex_fc-ucna_provider_Module: emulex_fc-ucna_provider_Module
   libEMULEX_CNA_PEG: EMULEX_CNA_PEG
   libFIOUtlProviderModule: FIOUtlProviderModule
   libFIO_Module: FIO_Module
   libHiddenLogProviderModule: HiddenLogProviderModule 
   libIntelMICProviderModule: IntelMICProviderModule 
   libSSDProviderModule: SSDProviderModule 
   libLSIUtlProviderModule: LSIUtlProviderModule 
   liblsiPCIeSSDProviderModule: lsiPCIeSSDProviderModule 
   libMLNX_CIMProvider_Module: MLNX_CIMProvider_Module 
   libLSIESG_SMIS13_HHR_ProviderModule: LSIESG_SMIS13_HHR_ProviderModule 
Running DSA Pegasus Multi-threads Group plug-ins pass 2.
   libbrcdprovider_Module: brcdprovider_Module 
   libDimmModule_Module: DimmModule_Module 
   libemulex_fc-ucna_provider_Module: emulex_fc-ucna_provider_Module 
   libMLNX_CIMProvider_Module: MLNX_CIMProvider_Module 
   libLSIESG_SMIS13_HHR_ProviderModule: LSIESG_SMIS13_HHR_ProviderModule 
Running DSA analyzer plug-ins pass 1.
   libbasicanal: Basic Analysis 
   libesainfo: ESA-DSA Information 
   liblpanal: Light Path Analysis 
Running DSA analyzer plug-ins pass 2.
   liblpanal: Light Path Analysis 
Adding DSA log entries to XML file.
Writing XML data to file /var/log/Lenovo_Support/5465AC1_1234567_20180716-121300.xml.gz

DSA capture completed successfully.
cp: failed to access '/etc/sysconfig/network/': Not a directory
cp: cannot stat '*-usb*': No such file or directory

Please press ANY key to continue ...
-->


<H1>No keyboard?</H1>

<div align="CENTER">
<A HREF="http://comic.browserling.com/tag/bios">
<IMG SRC="fig/keyboard.png"></A>
</div>



Dell iDrac serial over lan 
<BR>
ipmitool -I lanplus -U admin -P XXXXXXXXXXXX -H ipmi-ip sol activate
<BR>

<PRE>
KEY MAPPING FOR CONSOLE REDIRECTION:

Use the {ESC}{1} key sequence for {F1}
Use the {ESC}{2} key sequence for {F2}
Use the {ESC}{3} key sequence for {F3}
Use the {ESC}{0} key sequence for {F10}
Use the {ESC}{!} key sequence for {F11}
Use the {ESC}{@} key sequence for {F12}

Use the {ESC}{Ctrl}{M} key sequence for {Ctrl}{M}
Use the {ESC}{Ctrl}{H} key sequence for {Ctrl}{H}
Use the {ESC}{Ctrl}{I} key sequence for {Ctrl}{I}
Use the {ESC}{Ctrl}{J} key sequence for {Ctrl}{J}

Use the {ESC}{X}{X} key sequence for {Alt}{x}, where x is any letter
key, and X is the upper case of that key

Use the {ESC}{R}{ESC}{r}{ESC}{R} key sequence for {Ctrl}{Alt}{Del}

Press the spacebar to pause...
Initializing PCIe, USB, and Video... Done
BIOS update has started.

</PRE>

<H1>UEFI</H1>


<PRE>
Tyan: F11 for pop up menu, choose UEFI Shell


fd0:						# this pick the root device/dir for the UEFI shell.  after doing this, UEFI commands available.
fs0:\7109V102		# pick a specific dir to the the root of the EFI shell?

cd
ls
dir
help
tab completion works.  dir could be / or \  ?


*nsf					# these are executable in EFI.  
flash.nsh			# run the BIOS flash program


</PRE>



<!-- ################################################################## -->
<!-- ################################################################## -->
<!-- ################################################################## -->
<!-- ################################################################## -->
<!-- ################################################################## -->
<!-- ################################################################## -->
<!-- ################################################################## -->

<BR>

  
<div class="quote">
</div>


<BR><BR>
<HR>
<BR><BR>

<A NAME="cc"></A>
<A NAME="CreativeCommon"></A>
<H3>Copyright info about this work
</H3>    

<p>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/">Creative Commons Attribution-NonCommercial-ShareAlike2.5 License</a>.
       <!--/Creative Commons License-->
       <!-- <rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
       <Work rdf:about="">
       <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.5/" />
            <dc:title>Pocket Sys Admin Survival Guide</dc:title>
            <dc:date>2005</dc:date>
            <dc:description>A series of concise system administration notes</dc:description>
            <dc:creator><Agent><dc:title>Tin Ho</dc:title></Agent></dc:creator>
            <dc:rights><Agent><dc:title>Tin Ho</dc:title></Agent></dc:rights>
            <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
            <dc:source rdf:resource="http://tin6150.github.io/psg/" />
            </Work>
            <License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.5/"><permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
                                       <permits rdf:resource="http://web.resource.org/cc/Distribution"/>
                                       <requires rdf:resource="http://web.resource.org/cc/Notice"/><requires rdf:resource="http://web.resource.org/cc/Attribution"/>
                                       <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse"/>
                                       <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks"/><requires rdf:resource="http://web.resource.org/cc/ShareAlike"/>
            </License>
            </rdf:RDF> -->


<Strong>Pocket Sys Admin Survival Guide</Strong>: for content that I wrote, (<a
 href="http://creativecommons.org/licenses/by-nc-sa/2.5/">CC</a>)  
 <a href="http://creativecommons.org/learnmore"> <i>some rights reserved</i></a>.  
 2005,2012 Tin Ho [ tin6150 (at) gmail.com ]  <br>
 
Some contents are "cached" here for easy reference. Sources include man pages, 
vendor documents, online references, discussion groups, etc. Copyright of those 
are obviously those of the vendor and original authors.  I am merely caching them here for quick reference and avoid broken URL problems.
</p>

  <br><br>


<h3>Where is PSG hosted these days?</h3>
  <div id="psg-url">
  <a href="http://tin6150.github.io/psg/psg2.html">http://tin6150.github.io/psg/psg2.html</a> 
  This new home page at github<br>
  
  <A HREF="http://tiny.cc/tin6150"> 
  http://tiny.cc/tin6150/</A>
  New home in 2011.06.  <BR>



<A HREF="http://tin6150.s3-website-us-west-1.amazonaws.com/psg.html">http://tin6150.s3-website-us-west-1.amazonaws.com/psg.html</A> 
(coming soon)
<BR>
<a href="ftp://read:only@sn.is-a-geek.com/psg/psg.html">ftp://sn.is-a-geek.com/psg/psg.html</a> 
My home "server".  Up sporadically.
<BR>

<!--
Other caches in decreasing order of update frequency:  <BR>

<A HREF="http://tin6150.github.io/psg/psg.html">
http://tin6150.github.io/psg/psg.html
</A> 
(Google site, they are changing their policy and I may not be update these pages in the near future.  Last updated 2009-10-10)<BR>
-->


<A HREF="http://tin6150.github.io/psg/psg.html">http://tin6150.github.io/psg/psg.html</A> <BR>
<A HREF="http://www.fiu.edu/~tho01/psg/psg.html">http://www.fiu.edu/~tho01/psg/psg.html</A> (no longer updated as of 2007-05)<BR>

</div>       
      
      
      
      
      
      
      
      
      
      
      
      
  </div> <!-- #content -->
  
  
  <div id="tailer">      
            <div class="noicon">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/">
                <img alt="Creative Commons License" src="http://creativecommons.org/images/public/somerights20.png"></a>
            <a href="http://jigsaw.w3.org/css-validator/check/referer">
                <img style="border:0;width:88px;height:31px"
                    src="http://jigsaw.w3.org/css-validator/images/vcss-blue"
                    alt="Valid CSS!">
            </a>
            <a href="http://validator.w3.org/check?uri=referer">
                <img src="http://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01 Strict" height="31" width="88">
            </a>
        </div>
  </div> <!-- #tailer -->

  
  
  
  
  <div id="footer"> (CC 2012) Some Rights Reserved.</div>
  
</div> <!-- closes wrapper --> 
</body>
</html>
